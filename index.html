<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="jquery-3.4.0.min.js"></script>
</head>
<body>
	<input id="filter" onkeyup="filter()" />
	<p id="demo"></p>
	<script>
	 	var pagenum = 0;
	 	var list = new Array();
	 	var pages = new Array();

	 	function getData(pagenum) {
	 		return $.getJSON('http://www.whateverorigin.org/get?url=' + encodeURIComponent('https://www.profesia.sk/praca/informacne-technologie/?page_num=') + pagenum + '&callback=?', function(data){
	 			return data;
			});
	 	}

	 	function getPage(page) {
	 		return $.getJSON('http://www.whateverorigin.org/get?url=' + encodeURIComponent(page) + '&callback=?', function(data){
	 			return data;
			});
	 	}

		function escapeRegExp (string) {
		    return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')
		}

		function makeid(length) {
		   var result           = '';
		   var characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
		   var charactersLength = characters.length;
		   for ( var i = 0; i < length; i++ ) {
		      result += characters.charAt(Math.floor(Math.random() * charactersLength));
		   }
		   return result;
		}

		function compareFunction(a, b) {
			return ('' + $(a[1]).text().trim()).localeCompare($(b[1]).text().trim());
		}

		function filter() {
			filterterms = escapeRegExp($("#filter").val().toLowerCase()).split(" ");
			newlist = new Array();

			for(var i=0; i<list.length; i++) {
				yes = 1;
				for(var j=0; j<filterterms.length; j++) {
					if ($(list[i][1]).text().toLowerCase().search(filterterms[j]) < 0) yes = 0; 
				}
				if (yes) newlist.push(list[i]);
			}

			//newlist.sort(compareFunction);

			var together = "";
			for(var i=0; i<newlist.length; i++) {
				together += newlist[i][1] + "<br />";
				together += newlist[i][2] + "<br /><br />";
			}
			document.getElementById("demo").innerHTML = together;
		}

	 	do {
			pagenum++;
			getData(pagenum).then(function(data){
				link = $(data.contents).find("a[id^='offer']");
				if(link.length == 0) return;

				employer = $(data.contents).find("span[class='employer']");
				loc = $(data.contents).find("span[class='job-location']");
				
				for(var i=0; i<link.length; i++) {
					element = "<a href='https://profesia.sk" + $(link[i]).attr('href') + "'>" + $(link[i]).text().trim() + "</a> : : " + employer[i].innerText + " : : " + loc[i].innerText;

					code = makeid(6);
					list.push([code, element]);
					
					//maintextearea $(list[i][1]).attr('href')
					getPage($(list[i][1]).attr('href')).then(function(data){
						//cont = $(data.contents).find("div[class='maintextearea']");
						console.log("aasdasdasd");
					});
				}

				filter();
			});
		} while (pagenum < 1);
	</script>
</body>
</html>
